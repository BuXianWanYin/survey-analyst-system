# 在线问卷调查与数据分析系统前端开发规范文档

## 一、项目概述

### 1.1 技术栈

#### 前端技术栈

- **框架**：Vue 3.x
- **构建工具**：Vite
- **UI组件库**：Element Plus
- **图标库**：@element-plus/icons-vue
- **状态管理**：Pinia
- **路由**：Vue Router 4.x
- **HTTP客户端**：Axios
- **图表库**：ECharts 5.x
- **富文本编辑**：Quill
- **拖拽功能**：Vue Draggable / SortableJS
- **开发语言**：JavaScript (ES6+)

### 1.2 项目架构要求

- 前端采用组件化开发，模块化管理
- 前后端分离，通过RESTful API进行交互
- 使用Pinia进行状态管理
- 使用Vue Router进行路由管理
- 使用Axios进行HTTP请求封装
- 使用ECharts实现数据可视化

### 1.3 项目基础信息

- **项目名称**：在线问卷调查与数据分析系统前端
- **开发端口**：3000
- **API基础路径**：通过环境变量`VITE_APP_BASE_API`配置
- **请求超时时间**：通过环境变量`VITE_APP_TIMEOUT`配置

## 二、项目结构规范

### 2.1 目录结构

```
survey-analyst-web/
├── public/                 # 静态资源
├── src/
│   ├── api/               # API接口定义
│   │   ├── index.js       # API入口文件
│   │   ├── user.js        # 用户相关API
│   │   ├── survey.js      # 问卷相关API
│   │   ├── question.js    # 题目相关API
│   │   ├── response.js    # 填写记录相关API
│   │   ├── statistics.js  # 统计相关API
│   │   ├── analysis.js    # 分析相关API
│   │   ├── template.js    # 模板相关API
│   │   ├── file.js        # 文件相关API
│   │   └── admin.js       # 管理员相关API
│   ├── assets/            # 资源文件（图片、样式等）
│   ├── components/        # 公共组件
│   │   ├── common/        # 通用组件
│   │   └── business/      # 业务组件
│   ├── config/            # 配置文件
│   │   └── index.js       # 全局配置
│   ├── router/            # 路由配置
│   │   ├── index.js       # 路由入口
│   │   └── guard.js       # 路由守卫
│   ├── stores/            # 状态管理（Pinia）
│   │   ├── user.js        # 用户相关状态
│   │   ├── survey.js      # 问卷相关状态
│   │   └── ...            # 其他状态模块
│   ├── utils/             # 工具函数
│   │   ├── request.js     # 请求封装
│   │   ├── auth.js        # 认证工具
│   │   ├── constants.js  # 常量定义
│   │   ├── echarts.js     # ECharts工具
│   │   └── index.js       # 工具函数入口
│   ├── layouts/           # 布局组件
│   │   └── MainLayout.vue # 主布局（带顶部导航栏）
│   ├── views/             # 页面组件
│   │   ├── Home.vue       # 首页
│   │   ├── Login.vue      # 登录页
│   │   ├── Register.vue   # 注册页
│   │   ├── user/          # 用户相关页面
│   │   │   ├── SurveyDesign.vue      # 问卷设计页
│   │   │   ├── SurveyPublish.vue    # 问卷发布页
│   │   │   ├── SurveyList.vue        # 问卷列表页
│   │   │   ├── SurveyFill.vue         # 问卷填写页
│   │   │   ├── StatisticsOverview.vue # 统计概览
│   │   │   ├── StatisticsDetail.vue   # 统计详情
│   │   │   ├── CrossAnalysis.vue      # 交叉分析
│   │   │   ├── TrendAnalysis.vue      # 趋势分析
│   │   │   ├── ProfileAnalysis.vue    # 样本画像
│   │   │   ├── VisualizationDashboard.vue # 数据仪表盘
│   │   │   └── TemplateList.vue      # 模板列表
│   │   └── admin/         # 管理员后台页面
│   │       ├── Dashboard.vue          # 数据概览
│   │       ├── UserManage.vue         # 用户管理
│   │       ├── SurveyManage.vue        # 问卷管理
│   │       └── DataManage.vue         # 数据管理
│   ├── App.vue            # 根组件
│   └── main.js            # 入口文件
├── index.html             # HTML入口
├── package.json           # 依赖配置
├── vite.config.js         # Vite配置
└── README.md              # 项目说明
```

### 2.2 目录结构设计原则

- **角色分离**：用户相关页面和管理员后台页面用文件夹区分
- **页面统一**：所有用户业务页面统一放在user文件夹下，所有管理员页面统一放在admin文件夹下
- **职责明确**：不同功能的组件分开，便于管理和维护
- **可扩展性**：目录结构支持项目扩展

### 2.3 Views目录组织规范

#### 2.3.1 组织原则

**views目录下的组件按用户角色组织，用户相关页面统一放在user文件夹，管理员后台页面统一放在admin文件夹。**

#### 2.3.2 目录结构规范

```
views/
├── Home.vue                    # 首页（独立页面）
├── Login.vue                   # 登录页（独立页面）
├── Register.vue                # 注册页（独立页面）
├── user/                       # 用户相关页面（统一存放）
│   ├── SurveyDesign.vue        # 问卷设计页
│   ├── SurveyPublish.vue       # 问卷发布页
│   ├── SurveyList.vue          # 问卷列表页
│   ├── SurveyFill.vue          # 问卷填写页
│   ├── StatisticsOverview.vue  # 统计概览
│   ├── StatisticsDetail.vue    # 统计详情
│   ├── CrossAnalysis.vue       # 交叉分析
│   ├── TrendAnalysis.vue       # 趋势分析
│   ├── ProfileAnalysis.vue     # 样本画像
│   ├── VisualizationDashboard.vue # 数据仪表盘
│   ├── TemplateList.vue        # 模板列表
│   └── components/             # 用户页面公共组件
│       └── QuestionEditor.vue
└── admin/                      # 管理员后台页面（统一存放）
    ├── Dashboard.vue           # 数据概览
    ├── UserManage.vue          # 用户管理
    ├── SurveyManage.vue        # 问卷管理
    ├── DataManage.vue          # 数据管理
    └── components/             # 管理员页面公共组件
        └── ...
```

#### 2.3.3 页面组织规则

- **按角色划分**：用户相关页面统一放在user文件夹，管理员页面统一放在admin文件夹
- **页面命名**：页面组件使用大驼峰命名，清晰表达功能，如：`SurveyDesign.vue`、`StatisticsOverview.vue`
- **公共组件**：如果user或admin文件夹内有多个相关组件，可以在对应文件夹下创建`components`子目录

## 三、组件开发规范

### 3.1 组件命名规范

- 组件文件使用大驼峰命名，如：`UserList.vue`、`SurveyDesign.vue`
- 组件名必须具有业务含义，避免使用通用名称
- 公共组件放在`components/common`目录
- 业务组件放在`components/business`目录
- 页面组件放在`views`目录

### 3.2 组件结构规范

```vue
<template>
  <!-- 模板内容 -->
  <div class="component-name">
    <!-- 组件内容 -->
  </div>
</template>

<script setup>
/**
 * 组件说明
 * 功能：组件功能描述
 */

// 导入依赖
import { ref, reactive, computed, onMounted } from 'vue'
import { useRouter } from 'vue-router'

// 定义Props
const props = defineProps({
  // props定义
})

// 定义Emits
const emit = defineEmits(['event-name'])

// 响应式数据
const data = ref(null)
const form = reactive({
  // 表单数据
})

// 计算属性
const computedValue = computed(() => {
  // 计算逻辑
})

// 方法
const handleClick = () => {
  // 处理逻辑
}

// 生命周期
onMounted(() => {
  // 初始化逻辑
})
</script>

<style scoped>
.component-name {
  /* 样式内容 */
}
</style>
```

### 3.3 组件注释规范

- 组件文件头部添加组件说明
- 组件注释只包含功能描述，不包含作者和日期信息
- **禁止在注释中使用HTML标签**
- **禁止在代码和注释中引用第三方项目名称（如 tduck 等）**：所有代码和注释都应该是项目自身的实现，不应提及外部参考项目
- 复杂逻辑添加行内注释
- 方法添加注释说明功能

### 3.4 Vue3 写法规范

- **禁止使用原生DOM操作**：必须使用Vue3的响应式系统和组合式API
- **禁止使用 `document.addEventListener`**：应使用Vue3的自定义指令或组合式API实现事件监听
- **禁止使用 `document.querySelector`**：应使用模板引用（`ref`）或Vue3的响应式数据
- **必须使用Vue3指令**：如 `v-if`、`v-show`、`v-for`、`v-model` 等
- **必须使用组合式API**：使用 `<script setup>` 语法，使用 `ref`、`reactive`、`computed`、`watch` 等

## 四、API接口调用规范

### 4.1 API文件组织

- **按业务模块划分API目录**：每个业务模块创建独立的API文件
- **统一导出**：在`api/index.js`中统一导出所有API对象
- **文件命名规范**：使用小驼峰命名，如：`user.js`、`survey.js`
- **API对象命名规范**：使用模块名 + `Api`，如：`userApi`、`surveyApi`
- API方法命名使用动词开头，如：`getUserList`、`addSurvey`、`updateSurvey`、`deleteSurvey`

### 4.2 API文件目录结构

```
api/
├── index.js          # API统一导出入口
├── user.js           # 用户相关 API
├── survey.js         # 问卷相关 API
├── question.js       # 题目相关 API
├── response.js       # 填写记录相关 API
├── statistics.js     # 统计相关 API
├── analysis.js       # 分析相关 API
├── template.js       # 模板相关 API
├── file.js           # 文件相关 API
└── admin.js          # 管理员相关 API
```

### 4.3 API文件示例（推荐方式：对象导出）

```javascript
// api/survey.js
import request from '@/utils/request'

/**
 * 问卷相关 API
 */
export const surveyApi = {
  /**
   * 分页查询问卷列表
   * @param {Object} params 查询参数
   * @returns {Promise} 问卷列表
   */
  getSurveyPage(params) {
    return request.get('/survey/page', { params })
  },
  
  /**
   * 根据ID获取问卷详情
   * @param {Number} id 问卷ID
   * @returns {Promise} 问卷详情
   */
  getSurveyById(id) {
    return request.get(`/survey/${id}`)
  },
  
  /**
   * 创建问卷
   * @param {Object} data 问卷信息
   * @returns {Promise} 创建结果
   */
  createSurvey(data) {
    return request.post('/survey', data)
  },
  
  /**
   * 更新问卷
   * @param {Number} id 问卷ID
   * @param {Object} data 问卷信息
   * @returns {Promise} 更新结果
   */
  updateSurvey(id, data) {
    return request.put(`/survey/${id}`, data)
  },
  
  /**
   * 删除问卷
   * @param {Number} id 问卷ID
   * @returns {Promise} 删除结果
   */
  deleteSurvey(id) {
    return request.delete(`/survey/${id}`)
  }
}
```

### 4.4 API统一导出

```javascript
// api/index.js
/**
 * API统一导出入口
 * 按业务模块划分，每个模块创建独立的API文件
 */

// 用户相关 API
export { userApi } from './user'

// 问卷相关 API
export { surveyApi } from './survey'

// 题目相关 API
export { questionApi } from './question'

// 填写记录相关 API
export { responseApi } from './response'

// 统计相关 API
export { statisticsApi } from './statistics'

// 分析相关 API
export { analysisApi } from './analysis'

// 模板相关 API
export { templateApi } from './template'

// 文件相关 API
export { fileApi } from './file'

// 管理员相关 API
export { adminApi } from './admin'
```

### 4.5 API使用示例

```javascript
// 在组件中使用
import { surveyApi, userApi } from '@/api'

// 获取问卷列表
const list = await surveyApi.getSurveyPage({ pageNum: 1, pageSize: 10 })

// 获取用户信息
const user = await userApi.getCurrentUser()
```

### 4.6 请求封装规范

- 统一使用`@/utils/request.js`中的axios实例进行HTTP请求
- 请求拦截器：自动添加Token、设置请求头
- 响应拦截器：统一处理响应、错误处理
- 请求超时时间：通过环境变量配置（默认60秒）

### 4.7 请求方法规范

- **GET请求**：使用`params`传递查询参数，使用`request.get(url, { params })`
- **POST请求**：使用`data`传递请求体，使用`request.post(url, data)`
- **PUT请求**：使用`data`传递请求体，使用`request.put(url, data)`
- **DELETE请求**：路径参数通过URL传递，使用`request.delete(url)`

### 4.8 API注释规范

- 每个API文件顶部添加模块说明注释
- 每个API方法添加JSDoc注释，包含：
  - 方法功能说明
  - `@param` 参数说明（参数名、类型、说明）
  - `@returns` 返回值说明

## 五、状态管理规范（Pinia）

### 5.1 Store文件组织

- Store文件放在`stores`目录下
- 按业务模块划分Store，如：`user.js`、`survey.js`
- Store命名使用小驼峰，如：`useUserStore`、`useSurveyStore`

### 5.2 Store结构规范

```javascript
// stores/user.js
import { defineStore } from 'pinia'
import { userApi } from '@/api'

/**
 * 用户状态管理
 */
export const useUserStore = defineStore('user', {
  state: () => ({
    // 用户信息
    userInfo: null,
    // Token
    token: localStorage.getItem('survey_analyst_token') || '',
    // 刷新Token
    refreshToken: localStorage.getItem('survey_analyst_refresh_token') || ''
  }),

  getters: {
    /**
     * 是否已登录
     */
    isLoggedIn: (state) => {
      return !!state.token
    }
  },

  actions: {
    /**
     * 设置用户信息
     * @param {Object} userInfo 用户信息
     */
    setUserInfo(userInfo) {
      this.userInfo = userInfo
    },

    /**
     * 设置Token
     * @param {String} token Token
     */
    setToken(token) {
      this.token = token
      localStorage.setItem('survey_analyst_token', token)
    },

    /**
     * 获取用户信息
     */
    async fetchUserInfo() {
      try {
        const res = await userApi.getCurrentUser()
        this.setUserInfo(res.data)
      } catch (error) {
        console.error('获取用户信息失败:', error)
      }
    },

    /**
     * 退出登录
     */
    logout() {
      this.userInfo = null
      this.token = ''
      this.refreshToken = ''
      localStorage.removeItem('survey_analyst_token')
      localStorage.removeItem('survey_analyst_refresh_token')
    }
  }
})
```

### 5.3 Store使用规范

- 在组件中使用`useStore()`获取Store实例
- 使用`store.xxx`访问state
- 使用`store.xxx()`调用actions
- 使用`store.xxx`访问getters

**示例：**

```vue
<script setup>
import { useUserStore } from '@/stores/user'

const userStore = useUserStore()

// 访问state
const userInfo = userStore.userInfo

// 调用action
userStore.fetchUserInfo()

// 访问getter
const isLoggedIn = userStore.isLoggedIn
</script>
```

## 六、路由管理规范

### 6.1 路由文件组织

- 路由配置文件：`router/index.js`
- 路由守卫文件：`router/guard.js`
- 路由按业务模块组织，使用嵌套路由

### 6.2 路由配置规范

#### 6.2.1 布局组件使用

路由配置中，通过 `component` 指定布局组件，通过 `children` 配置子路由（页面组件）：

```javascript
// router/index.js
import { createRouter, createWebHistory } from 'vue-router'
import { setupRouterGuard } from './guard'
import MainLayout from '@/layouts/MainLayout.vue'

const routes = [
  // 认证页面（无布局）
  {
    path: '/login',
    name: 'Login',
    component: () => import('@/views/Login.vue'),
    meta: {
      title: '登录',
      requiresAuth: false
    }
  },
  {
    path: '/register',
    name: 'Register',
    component: () => import('@/views/Register.vue'),
    meta: {
      title: '注册',
      requiresAuth: false
    }
  },
  
  // 主布局（带顶部导航栏）- 所有业务页面统一使用
  {
    path: '/',
    component: MainLayout,
    redirect: '/home',
    meta: {
      requiresAuth: true
    },
    children: [
      {
        path: 'home',
        name: 'Home',
        component: () => import('@/views/Home.vue'),
        meta: {
          title: '首页',
          requiresAuth: true
        }
      },
      {
        path: 'user/survey/design',
        name: 'SurveyDesign',
        component: () => import('@/views/user/SurveyDesign.vue'),
        meta: {
          title: '问卷设计',
          requiresAuth: true
        }
      },
      {
        path: 'user/survey/list',
        name: 'SurveyList',
        component: () => import('@/views/user/SurveyList.vue'),
        meta: {
          title: '我的问卷',
          requiresAuth: true
        }
      },
      {
        path: 'user/statistics/overview/:id',
        name: 'StatisticsOverview',
        component: () => import('@/views/user/StatisticsOverview.vue'),
        meta: {
          title: '数据统计',
          requiresAuth: true
        }
      }
    ]
  },
  
  // 管理员后台（独立布局）
  {
    path: '/admin',
    component: () => import('@/layouts/AdminLayout.vue'),
    redirect: '/admin/dashboard',
    meta: {
      requiresAuth: true,
      requiresAdmin: true
    },
    children: [
      {
        path: 'dashboard',
        name: 'AdminDashboard',
        component: () => import('@/views/admin/Dashboard.vue'),
        meta: {
          title: '数据概览',
          requiresAuth: true,
          requiresAdmin: true
        }
      },
      {
        path: 'user',
        name: 'AdminUserManage',
        component: () => import('@/views/admin/UserManage.vue'),
        meta: {
          title: '用户管理',
          requiresAuth: true,
          requiresAdmin: true
        }
      },
      {
        path: 'survey',
        name: 'AdminSurveyManage',
        component: () => import('@/views/admin/SurveyManage.vue'),
        meta: {
          title: '问卷管理',
          requiresAuth: true,
          requiresAdmin: true
        }
      },
      {
        path: 'data',
        name: 'AdminDataManage',
        component: () => import('@/views/admin/DataManage.vue'),
        meta: {
          title: '数据管理',
          requiresAuth: true,
          requiresAdmin: true
        }
      }
    ]
  }
]

const router = createRouter({
  history: createWebHistory(),
  routes
})

// 设置路由守卫
setupRouterGuard(router)

export default router
```

#### 6.2.2 布局选择指南

**使用 MainLayout 的场景：**
- 所有业务页面统一使用 MainLayout
- 问卷设计、问卷列表、数据统计等需要顶部导航栏的页面
- 需要搜索功能的页面

**使用 AdminLayout 的场景：**
- 管理员后台的所有页面
- 需要管理员权限的页面

**不使用布局的场景：**
- 登录、注册等认证页面
- 问卷填写页面（独立页面，不需要导航栏）

### 6.3 路由守卫规范

```javascript
// router/guard.js
import { getToken } from '@/utils/auth'

/**
 * 设置路由守卫
 * @param {Router} router Vue Router实例
 */
export function setupRouterGuard(router) {
  // 前置守卫
  router.beforeEach((to, from, next) => {
    // 设置页面标题
    if (to.meta.title) {
      document.title = `${to.meta.title} - 在线问卷调查与数据分析系统`
    }
    
    // 检查是否需要登录
    if (to.meta.requiresAuth) {
      const token = getToken()
      if (!token) {
        // 未登录，跳转到登录页
        next({
          name: 'Login',
          query: {
            redirect: to.fullPath
          }
        })
        return
      }
    }
    
    // 检查是否需要管理员权限
    if (to.meta.requiresAdmin) {
      // 检查用户角色（从Store或Token中获取）
      const userStore = useUserStore()
      if (!userStore.userInfo || userStore.userInfo.role !== 'ADMIN') {
        ElMessage.warning('您没有权限访问此页面')
        next({ name: 'Home' })
        return
      }
    }
    
    next()
  })
  
  // 后置守卫
  router.afterEach(() => {
    // 可以在这里处理一些后置逻辑，如埋点等
  })
}
```

### 6.4 路由命名规范

- 路由名称使用大驼峰，如：`SurveyDesign`、`StatisticsOverview`
- 路由路径使用小写字母和连字符，如：`/survey-design`、`/statistics-overview`
- 路由meta信息必须包含`title`和`requiresAuth`字段

## 七、工具函数规范

### 7.1 请求封装（request.js）

- 统一使用axios进行HTTP请求
- 请求拦截器：添加Token、设置请求头
- 响应拦截器：统一处理响应、错误处理
- 请求超时时间：通过环境变量配置

**关键配置：**

```javascript
// utils/request.js
import axios from 'axios'
import { ElMessage, ElMessageBox } from 'element-plus'
import { getToken, removeToken } from './auth'

const service = axios.create({
  baseURL: import.meta.env.VITE_APP_BASE_API,
  timeout: parseInt(import.meta.env.VITE_APP_TIMEOUT),
  headers: {
    'Content-Type': 'application/json'
  }
})

// 请求拦截器
service.interceptors.request.use(
  (config) => {
    const token = getToken()
    if (token) {
      config.headers['Authorization'] = `Bearer ${token}`
    }
    return config
  },
  (error) => {
    return Promise.reject(error)
  }
)

// 响应拦截器
service.interceptors.response.use(
  (response) => {
    const res = response.data
    if (res.code !== 200) {
      ElMessage.error(res.message || '请求失败')
      if (res.code === 401) {
        // 未授权，清除token并跳转登录
        removeToken()
        location.reload()
      }
      return Promise.reject(new Error(res.message || '请求失败'))
    }
    return res
  },
  (error) => {
    // 错误处理
    return Promise.reject(error)
  }
)

export default service
```

### 7.2 认证工具（auth.js）

- Token存储：使用`localStorage`
- Token键名：`survey_analyst_token`
- 刷新Token键名：`survey_analyst_refresh_token`
- 用户信息键名：`survey_analyst_user_info`

**关键方法：**

```javascript
// utils/auth.js
const TOKEN_KEY = 'survey_analyst_token'
const REFRESH_TOKEN_KEY = 'survey_analyst_refresh_token'
const USER_INFO_KEY = 'survey_analyst_user_info'

/**
 * 获取Token
 */
export function getToken() {
  return localStorage.getItem(TOKEN_KEY)
}

/**
 * 设置Token
 */
export function setToken(token) {
  localStorage.setItem(TOKEN_KEY, token)
}

/**
 * 移除Token
 */
export function removeToken() {
  localStorage.removeItem(TOKEN_KEY)
  localStorage.removeItem(REFRESH_TOKEN_KEY)
  localStorage.removeItem(USER_INFO_KEY)
}
```

### 7.3 常量定义（constants.js）

- 所有常量统一在`utils/constants.js`中定义
- 常量使用大写下划线命名，如：`API_BASE_URL`、`TOKEN_KEY`
- 常量按功能分组，添加注释说明

**示例：**

```javascript
// utils/constants.js
// API 路径
export const API_BASE_URL = import.meta.env.VITE_APP_BASE_API

// 请求超时时间
export const REQUEST_TIMEOUT = parseInt(import.meta.env.VITE_APP_TIMEOUT)

// Token 相关
export const TOKEN_KEY = 'survey_analyst_token'
export const REFRESH_TOKEN_KEY = 'survey_analyst_refresh_token'
export const USER_INFO_KEY = 'survey_analyst_user_info'

// 响应状态码
export const RESPONSE_CODE = {
  SUCCESS: 200,
  UNAUTHORIZED: 401,
  FORBIDDEN: 403,
  NOT_FOUND: 404,
  SERVER_ERROR: 500
}
```

### 7.4 ECharts工具（echarts.js）

- 统一封装ECharts图表配置
- 提供常用图表类型的配置模板
- 统一图表样式和主题

**示例：**

```javascript
// utils/echarts.js
import * as echarts from 'echarts'

/**
 * 创建柱状图配置
 * @param {Array} data 数据
 * @param {Array} categories 分类
 * @returns {Object} ECharts配置
 */
export function createBarChartOption(data, categories) {
  return {
    tooltip: {
      trigger: 'axis'
    },
    xAxis: {
      type: 'category',
      data: categories
    },
    yAxis: {
      type: 'value'
    },
    series: [{
      data: data,
      type: 'bar'
    }]
  }
}
```

## 八、代码质量规范

### 8.1 控制流嵌套规范

- **嵌套层级限制**：方法中的 if/else 嵌套层级不应超过 3 层
- **提取方法**：当嵌套层级超过 3 层时，必须提取为独立函数
- **提前返回**：优先使用提前返回（Early Return）模式，减少嵌套

### 8.2 函数长度规范

- **函数长度限制**：单个函数代码行数不应超过 80 行
- **职责单一**：函数应只做一件事，保持职责单一
- **提取函数**：当函数过长时，应提取为多个独立函数

### 8.3 代码可读性规范

- **函数命名**：函数名应清晰表达函数功能
- **注释规范**：复杂业务逻辑必须添加注释说明
- **变量命名**：变量名应具有业务含义，避免使用单字母变量

### 8.4 变量命名规范

- **变量命名**：使用小驼峰，如：`userName`、`surveyList`
- **常量命名**：使用大写下划线，如：`API_BASE_URL`、`TOKEN_KEY`
- **函数命名**：使用动词开头，如：`getUserList`、`addSurvey`
- **组件命名**：使用大驼峰，如：`UserList`、`SurveyDesign`

### 8.5 代码格式规范

- 使用2个空格缩进
- 使用单引号（'）而非双引号（"）
- 语句末尾不使用分号（根据项目配置）
- 对象和数组最后一个元素后不加逗号（根据项目配置）

### 8.6 ESLint 格式规范

#### 8.6.1 ESLint 配置说明

项目使用 ESLint 进行代码质量检查和格式规范，配置文件为 `.eslintrc.cjs`。

**基础配置：**
- 使用 `eslint:recommended` 作为基础规则集
- 支持 Vue 3 语法检查
- 支持 ES2021 语法
- 支持浏览器和 Node.js 环境

#### 8.6.2 代码格式规范

**引号规范：**
- **必须使用单引号**：字符串使用单引号（'），避免使用双引号（"）
- **模板字符串**：允许使用模板字符串（反引号）

```javascript
// ✅ 正确
const name = 'John'
const message = `Hello, ${name}`

// ❌ 错误
const name = "John"
```

**分号规范：**
- **语句末尾不使用分号**：JavaScript 语句末尾不使用分号（根据项目配置）

```javascript
// ✅ 正确
const name = 'John'
const age = 20

// ❌ 错误
const name = 'John';
const age = 20;
```

**缩进规范：**
- **使用 2 个空格缩进**：不使用 Tab，统一使用 2 个空格

```javascript
// ✅ 正确
function example() {
  if (condition) {
    doSomething()
  }
}

// ❌ 错误（使用 Tab 或 4 个空格）
function example() {
    if (condition) {
        doSomething()
    }
}
```

**逗号规范：**
- **多行对象和数组**：最后一个元素后可以加逗号（trailing comma）
- **单行对象和数组**：不使用尾随逗号

```javascript
// ✅ 正确（多行）
const obj = {
  name: 'John',
  age: 20,
}

const arr = [
  1,
  2,
  3,
]

// ✅ 正确（单行）
const obj = { name: 'John', age: 20 }
const arr = [1, 2, 3]
```

#### 8.6.3 Vue 组件规范

**组件命名规范：**
- **多词组件名**：组件名必须由多个单词组成（`vue/multi-word-component-names` 规则已关闭，但建议遵循）
- **大驼峰命名**：组件文件使用大驼峰命名，如：`UserList.vue`、`SurveyDesign.vue`

**Props 规范：**
- **Props 修改**：禁止直接修改 props（`vue/no-mutating-props` 规则已关闭，但建议遵循）
- 如需修改 props，应使用 `emit` 通知父组件或创建本地副本

```vue
<!-- ✅ 正确 -->
<script setup>
const props = defineProps(['value'])
const localValue = ref(props.value)

const updateValue = (newValue) => {
  localValue.value = newValue
  emit('update:value', newValue)
}
</script>

<!-- ❌ 错误 -->
<script setup>
const props = defineProps(['value'])
props.value = 'new value' // 禁止直接修改 props
</script>
```

**v-html 使用规范：**
- **谨慎使用 v-html**：使用 `v-html` 时需注意 XSS 攻击风险（`vue/no-v-html` 规则为警告级别）
- 必须对用户输入进行转义和验证

```vue
<!-- ⚠️ 警告：使用 v-html 需谨慎 -->
<div v-html="sanitizedHtml"></div>
```

**HTML 缩进规范：**
- **HTML 标签缩进**：Vue 模板中的 HTML 标签缩进由 Prettier 或编辑器自动处理（`vue/html-indent` 规则已关闭）

#### 8.6.5 ESLint 规则扩展

项目使用以下 ESLint 扩展：

- **eslint:recommended**：ESLint 推荐规则集
- **plugin:vue/vue3-essential**：Vue 3 基础规则
- **plugin:vue/vue3-strongly-recommended**：Vue 3 强烈推荐规则
- **plugin:vue/vue3-recommended**：Vue 3 推荐规则

#### 8.6.6 ESLint 自定义规则

项目自定义的 ESLint 规则：

```javascript
{
  // 控制台输出警告
  'no-console': 'warn',
  'no-debugger': 'warn',
  
  // Vue 组件规则
  'vue/multi-word-component-names': 'off',        // 允许单词组件名
  'vue/no-mutating-props': 'off',                 // 允许修改 props（不推荐）
  'vue/no-v-html': 'warn',                        // v-html 使用警告
  'vue/html-indent': 'off'                        // HTML 缩进由 Prettier 处理
}
```

#### 8.6.7 ESLint 使用指南

**运行 ESLint 检查：**

```bash
# 检查代码
npm run lint

# 自动修复可修复的问题
npm run lint -- --fix
```

**在开发工具中集成：**
- 推荐在 VS Code 中安装 ESLint 插件
- 保存文件时自动修复格式问题
- 实时显示代码问题提示

**提交前检查：**
- 提交代码前运行 `npm run lint` 确保代码符合规范
- 建议配置 Git Hooks（如 husky）在提交前自动运行 ESLint

#### 8.6.8 常见 ESLint 错误处理

**忽略特定规则：**
- 使用注释临时忽略特定规则（不推荐，应尽量修复问题）

```javascript
// eslint-disable-next-line no-console
console.log('Debug info')

// eslint-disable-line no-console
console.log('Debug info')

/* eslint-disable */
// 多行代码忽略
/* eslint-enable */
```

**忽略整个文件：**
- 在文件顶部添加注释忽略整个文件的 ESLint 检查

```javascript
/* eslint-disable */
// 整个文件忽略 ESLint 检查
```

**注意：** 应尽量避免使用 `eslint-disable`，优先修复代码问题。


## 十、Vite配置规范

### 10.1 Vite配置文件

- 配置文件：`vite.config.js`
- 使用环境变量配置代理和端口
- 配置路径别名：`@`指向`src`目录

### 10.2 Vite配置示例

```javascript
// vite.config.js
import { defineConfig, loadEnv } from 'vite'
import vue from '@vitejs/plugin-vue'
import { fileURLToPath, URL } from 'node:url'

export default defineConfig(({ mode }) => {
  const env = loadEnv(mode, process.cwd())
  
  const serverPort = parseInt(env.VITE_SERVER_PORT)
  const proxyTarget = env.VITE_SERVER_PROXY_TARGET
  const baseApi = env.VITE_APP_BASE_API
  
  return {
    plugins: [vue()],
    server: {
      port: serverPort,
      proxy: {
        [baseApi]: {
          target: proxyTarget,
          changeOrigin: true,
          rewrite: (path) => path.replace(new RegExp(`^${baseApi}`), '')
        }
      }
    },
    resolve: {
      alias: {
        '@': fileURLToPath(new URL('./src', import.meta.url))
      }
    }
  }
})
```

## 十一、Element Plus使用规范

### 11.1 组件导入规范

- 按需导入：只导入使用的组件，减少打包体积
- 全局注册：在`main.js`中注册常用组件

### 11.2 组件使用规范

- 使用Element Plus提供的组件，保持UI风格统一
- 遵循Element Plus的设计规范
- 自定义样式使用`scoped`，避免全局污染

### 11.3 表单验证规范

- 使用Element Plus的表单验证功能
- 表单规则统一在组件内定义
- 错误提示信息清晰明确

**示例：**

```vue
<template>
  <el-form :model="form" :rules="rules" ref="formRef">
    <el-form-item label="问卷标题" prop="title">
      <el-input v-model="form.title" />
    </el-form-item>
  </el-form>
</template>

<script setup>
const form = reactive({
  title: ''
})

const rules = {
  title: [
    { required: true, message: '请输入问卷标题', trigger: 'blur' }
  ]
}
</script>
```

## 十二、ECharts使用规范

### 12.1 图表组件封装

- 统一使用`vue-echarts`组件封装ECharts
- 图表配置统一在工具函数中定义
- 图表样式统一，保持视觉一致性

### 12.2 图表类型规范

- **柱状图**：用于选项分布统计
- **饼图**：用于选项比例展示
- **折线图**：用于趋势分析
- **雷达图**：用于多维度对比
- **散点图**：用于相关性分析
- **词云图**：用于文本分析

### 12.3 图表使用示例

```vue
<template>
  <v-chart :option="chartOption" style="height: 400px;" />
</template>

<script setup>
import { use } from 'echarts/core'
import { CanvasRenderer } from 'echarts/renderers'
import { BarChart } from 'echarts/charts'
import {
  TitleComponent,
  TooltipComponent,
  LegendComponent
} from 'echarts/components'
import VChart from 'vue-echarts'

use([
  CanvasRenderer,
  BarChart,
  TitleComponent,
  TooltipComponent,
  LegendComponent
])

const chartOption = ref({
  tooltip: {
    trigger: 'axis'
  },
  xAxis: {
    type: 'category',
    data: ['选项1', '选项2', '选项3']
  },
  yAxis: {
    type: 'value'
  },
  series: [{
    data: [120, 200, 150],
    type: 'bar'
  }]
})
</script>
```

## 十三、UI/UX设计规范

### 13.1 配色方案规范

#### 13.1.1 主色调

- **主色调**：`#409EFF`（Element Plus默认主色）
- **主色hover**：`#66B1FF`
- **主色浅色**：`#ECF5FF`

#### 13.1.2 中性色

- **背景色**：
  - 主背景：`#F5F5F5`（浅灰）
  - 次背景：`#FFFFFF`（白色）
  - 卡片背景：`#FFFFFF`（白色）
- **边框色**：`#E0E0E0`（浅灰）
- **文字色**：
  - 主文字：`#303133`（深灰）
  - 常规文字：`#606266`（中灰）
  - 次要文字：`#909399`（浅灰）

#### 13.1.3 状态色

- **成功**：`#67C23A`（成功绿）
- **警告**：`#E6A23C`（警告黄）
- **错误**：`#F56C6C`（错误红）
- **信息**：`#909399`（灰色）

### 13.2 布局规范

#### 13.2.1 页面布局原则

- **简洁明了**：界面布局清晰，减少视觉干扰
- **信息层次**：重要信息突出，次要信息弱化
- **操作便捷**：常用功能易于访问，减少操作步骤
- **响应式设计**：适配不同屏幕尺寸（PC、平板、手机）
- **一致性**：同类页面保持一致的布局结构

#### 13.2.2 布局结构

- **顶部导航栏**：高度60px，固定顶部
- **主内容区**：最大宽度1400px，居中显示
- **卡片间距**：20px
- **内容内边距**：20px

### 13.3 响应式设计规范

#### 13.3.1 断点设置

- **移动端**：`< 768px`（手机）
- **平板端**：`768px - 1024px`（平板）
- **PC端**：`> 1024px`（桌面）

#### 13.3.2 适配策略

- **移动端**：单列布局，导航改为底部导航栏，卡片全宽显示
- **平板端**：双列布局，侧边栏可收起，卡片自适应宽度
- **PC端**：多列布局，侧边栏固定，卡片按网格排列

## 十四、错误处理规范

### 14.1 API错误处理

- 统一在`request.js`的响应拦截器中处理错误
- 根据错误码显示不同的错误提示
- 401错误自动跳转登录页

### 14.2 组件错误处理

- 使用`try-catch`捕获异步错误
- 错误信息使用`ElMessage`提示用户
- 关键操作失败时提供重试机制

**示例：**

```javascript
const handleSubmit = async () => {
  try {
    await submitForm()
    ElMessage.success('操作成功')
  } catch (error) {
    ElMessage.error(error.message || '操作失败')
  }
}
```

## 十五、性能优化规范

### 15.1 路由懒加载

- 所有路由组件使用懒加载
- 减少首屏加载时间

**示例：**

```javascript
{
  path: '/survey/design',
  component: () => import('@/views/survey/Design.vue')
}
```

### 15.2 组件懒加载

- 大型组件使用`defineAsyncComponent`懒加载
- 减少初始打包体积

### 15.3 图片优化

- 使用合适的图片格式（WebP、PNG、JPG）
- 大图片使用懒加载
- 使用CDN加速静态资源

## 十六、安全规范

### 16.1 数据安全

- Token存储在`localStorage`，注意XSS攻击防护
- 敏感信息不在前端存储
- 用户输入必须进行校验和转义

### 16.2 接口安全

- 所有接口请求自动携带Token
- Token过期自动跳转登录页
- 防止CSRF攻击（后端配合）

### 16.3 前端安全

- 使用HTTPS协议（生产环境）
- 避免在URL中传递敏感信息
- 防止XSS攻击：对用户输入进行转义

## 十七、问卷设计器开发规范

### 17.1 拖拽功能实现

- 使用`Vue Draggable`或`SortableJS`实现题目拖拽排序
- 拖拽区域使用`v-for`渲染题目列表
- 拖拽时提供视觉反馈

### 17.2 题型组件规范

- 每种题型创建独立的组件
- 题型组件统一放在`components/business/question-types`目录
- 题型组件必须支持编辑和预览两种模式

### 17.3 逻辑跳转配置

- 逻辑跳转规则使用可视化配置界面
- 逻辑规则数据存储在问卷实体中
- 填写时根据逻辑规则动态显示/隐藏题目

## 十八、数据可视化开发规范

### 18.1 图表组件封装

- 统一封装常用图表类型为组件
- 图表组件放在`components/business/charts`目录
- 图表配置通过props传入，支持自定义配置

### 18.2 图表数据格式

- 统一图表数据格式，便于数据转换
- 提供数据转换工具函数
- 支持实时数据更新

### 18.3 图表交互规范

- 图表支持缩放、筛选等交互功能
- 图表支持导出为PNG格式
- 图表支持响应式适配

## 十九、管理员后台开发规范

### 19.1 后台布局

- 管理员后台使用独立的布局组件`AdminLayout.vue`
- 后台布局包含侧边栏导航和主内容区
- 后台路由使用`/admin`前缀

### 19.2 权限控制

- 后台所有页面必须进行管理员权限验证
- 权限验证在路由守卫中实现
- 非管理员用户访问后台时提示并跳转

### 19.3 数据管理功能

- 用户管理：支持查看、编辑、删除用户
- 问卷管理：支持查看、审核、删除问卷
- 数据管理：支持查看、导出、清理填写数据

## 二十、总结

本规范文档涵盖了在线问卷调查与数据分析系统前端开发的核心规范，包括：

- 技术栈选择（Vue 3、Vite、Element Plus、Pinia等）
- 项目结构设计
- 组件开发规范
- API接口调用规范
- 状态管理规范（Pinia）
- 路由管理规范
- 工具函数规范
- 代码质量规范
- 环境变量配置规范
- Vite配置规范
- Element Plus使用规范
- ECharts使用规范
- UI/UX设计规范
- 错误处理规范
- 性能优化规范
- 安全规范
- 问卷设计器开发规范
- 数据可视化开发规范
- 管理员后台开发规范

开发团队应严格遵守本规范，确保代码质量和项目的可维护性，同时提供良好的用户体验。

