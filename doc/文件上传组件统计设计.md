# 文件上传组件统计设计文档

## 一、组件类型

### 1.1 文件上传（UPLOAD）
- **存储格式**：数组格式，每个元素包含文件信息（name, url, size等）
- **支持**：单选或多选（通过 config.multiple 控制）
- **文件类型**：任意类型（通过 config.accept 限制）

### 1.2 图片上传（IMAGE_UPLOAD）
- **存储格式**：数组格式，每个元素包含图片信息（name, url, size等）
- **支持**：多选（通常可上传多张图片）
- **文件类型**：仅图片类型

---

## 二、统计设计方案

### 2.1 统计指标

#### 基础统计
- **有效上传数**：统计有上传文件的答案数量
- **总答案数**：所有填写数（包括未上传的）
- **上传率**：有效上传数 / 总答案数 × 100%

#### 文件统计（UPLOAD）
- **总文件数**：所有上传的文件总数
- **平均文件数**：总文件数 / 有效上传数
- **文件类型分布**：统计不同文件类型的数量（PDF、Word、Excel等）
- **文件大小统计**：总大小、平均大小、最大/最小文件

#### 图片统计（IMAGE_UPLOAD）
- **总图片数**：所有上传的图片总数
- **平均图片数**：总图片数 / 有效上传数
- **图片预览网格**：展示所有上传的图片（缩略图），支持点击放大查看
- **图片大小统计**：总大小、平均大小

### 2.2 展示方式

#### 方案一：卡片式统计（推荐）⭐

**UPLOAD（文件上传）展示：**
```
┌─────────────────────────────────────┐
│ 第 X 题：上传简历                   │
│ [文件上传]                          │
├─────────────────────────────────────┤
│ 统计信息：                          │
│ 有效上传数: 15  总答案数: 20       │
│ 上传率: 75%                         │
│                                     │
│ 文件统计：                          │
│ 总文件数: 15                        │
│ 平均文件数: 1.0                     │
│                                     │
│ 文件类型分布：                      │
│ PDF (10)  ████████████ 66.7%      │
│ DOC (3)   ███        20.0%         │
│ DOCX (2)  ██         13.3%         │
│                                     │
│ 文件大小：                          │
│ 总大小: 45.2 MB                     │
│ 平均大小: 3.01 MB                   │
│ 最大文件: 8.5 MB                    │
│ 最小文件: 0.5 MB                    │
└─────────────────────────────────────┘
```

**IMAGE_UPLOAD（图片上传）展示：**
```
┌─────────────────────────────────────┐
│ 第 X 题：上传照片                   │
│ [图片上传]                          │
├─────────────────────────────────────┤
│ 统计信息：                          │
│ 有效上传数: 18  总答案数: 20       │
│ 上传率: 90%                         │
│                                     │
│ 图片统计：                          │
│ 总图片数: 45                        │
│ 平均图片数: 2.5                     │
│                                     │
│ 图片预览（45 张）：                 │
│ ┌────┐ ┌────┐ ┌────┐ ┌────┐     │
│ │图片│ │图片│ │图片│ │图片│ ... │
│ └────┘ └────┘ └────┘ └────┘     │
│                                     │
│ 图片大小：                          │
│ 总大小: 120.5 MB                    │
│ 平均大小: 2.68 MB                   │
└─────────────────────────────────────┘
```

#### 方案二：表格式统计

**文件列表表格：**
```
┌──────────────┬──────────┬──────────┬────────┐
│ 文件名       │ 类型     │ 大小     │ 上传时间│
├──────────────┼──────────┼──────────┼────────┤
│ resume1.pdf  │ PDF      │ 2.5 MB   │ ...    │
│ resume2.doc  │ DOC      │ 1.8 MB   │ ...    │
│ ...          │ ...      │ ...      │ ...    │
└──────────────┴──────────┴──────────┴────────┘
```

---

## 三、实现建议

### 3.1 后端实现

#### 数据结构
```json
{
  "validUploads": 15,
  "totalAnswers": 20,
  "uploadRate": 75.0,
  "totalFiles": 15,
  "averageFiles": 1.0,
  "fileTypeStats": [
    { "type": "PDF", "count": 10, "percentage": 66.7 },
    { "type": "DOC", "count": 3, "percentage": 20.0 },
    { "type": "DOCX", "count": 2, "percentage": 13.3 }
  ],
  "fileSizeStats": {
    "totalSize": 47329920,
    "averageSize": 3155328,
    "maxSize": 8912896,
    "minSize": 524288
  },
  "fileList": [
    {
      "name": "resume1.pdf",
      "url": "/upload/files/xxx.pdf",
      "size": 2621440,
      "type": "application/pdf"
    }
  ]
}
```

#### 统计逻辑
1. 遍历所有表单数据
2. 检查该字段的值是否为数组且非空
3. 统计：
   - 有效上传数（有文件/图片的答案数）
   - 总文件/图片数
   - 文件类型分布（提取文件扩展名）
   - 文件大小统计

### 3.2 前端实现

#### 统计展示
- 使用 `el-statistic` 展示基础统计信息
- 使用饼图/柱状图展示文件类型分布
- 使用图片网格展示图片预览（仅 IMAGE_UPLOAD）
- 文件列表使用表格展示（可选）

#### 功能特性
- 图片预览：点击图片可放大查看
- 文件下载：点击文件名可下载文件（如果有权限）
- 文件类型图标：根据文件类型显示对应图标

---

## 四、推荐方案

### 4.1 UPLOAD（文件上传）
**推荐：方案一（卡片式统计）**

**展示内容：**
- ✅ 基础统计（有效上传数、总答案数、上传率）
- ✅ 文件统计（总文件数、平均文件数）
- ✅ 文件类型分布（图表）
- ✅ 文件大小统计
- ⬜ 文件列表表格（可选，数据量大时不推荐）

### 4.2 IMAGE_UPLOAD（图片上传）
**推荐：方案一（卡片式统计 + 图片预览网格）**

**展示内容：**
- ✅ 基础统计（有效上传数、总答案数、上传率）
- ✅ 图片统计（总图片数、平均图片数）
- ✅ 图片预览网格（类似签名组件）
- ✅ 图片大小统计
- ⬜ 图片列表表格（可选）

---

## 五、实现优先级

**第一阶段（高优先级）：**
- ✅ 基础统计（有效上传数、总答案数、上传率）
- ✅ 总文件/图片数、平均文件/图片数
- ✅ 图片预览网格（IMAGE_UPLOAD）

**第二阶段（中优先级）：**
- ⬜ 文件类型分布（UPLOAD）
- ⬜ 文件大小统计
- ⬜ 图片大小统计

**第三阶段（低优先级）：**
- ⬜ 文件列表表格
- ⬜ 文件下载功能
- ⬜ 文件类型图标

