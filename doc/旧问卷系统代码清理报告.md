# 旧问卷系统代码清理报告

## 发现的问题

### 1. FormItem 实体类
- ❌ 还有 `questionId` 字段（第37-39行）
- ❌ 数据库字段已删除，但实体类中还有

### 2. FormController
- ❌ 还有设置 `questionId` 的代码（第107-119行）
- ❌ 数据库字段已删除，代码不会生效

### 3. FormItemService 接口
- ❌ `getFormItemIdByQuestionId(Long questionId)` 方法
- ❌ `getFormItemIdByFormKeyAndQuestionId(String formKey, Long questionId)` 方法
- ❌ 这两个方法依赖已删除的 `question_id` 字段

### 4. FormItemServiceImpl 实现
- ❌ 两个方法的实现使用 `FormItem::getQuestionId`
- ❌ 数据库字段已删除，会报错

### 5. ResponseServiceImpl
- ❌ 使用 `getFormItemIdByFormKeyAndQuestionId` 方法
- ❌ 接收的 `answers` 参数是 `Map<Long, Object>`，key 是 `questionId`

## 需要修复的文件

1. `FormItem.java` - 删除 `questionId` 字段
2. `FormController.java` - 删除设置 `questionId` 的代码
3. `FormItemService.java` - 删除或标记废弃使用 `questionId` 的方法
4. `FormItemServiceImpl.java` - 删除或标记废弃使用 `questionId` 的方法实现
5. `ResponseServiceImpl.java` - 修改为不再使用 `questionId`

## 注意事项

`ResponseServiceImpl` 中接收的 `answers` 参数格式可能需要修改，需要检查前端如何调用。

