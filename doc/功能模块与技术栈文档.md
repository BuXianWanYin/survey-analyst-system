# 在线问卷调查与数据分析系统 - 功能模块与技术栈文档

## 一、系统概述

本系统是一个基于Web的在线问卷调查与数据分析系统，旨在解决传统问卷调查中设计繁琐、统计低效、分析浅薄等问题。系统采用B/S架构，前端使用JavaScript、Vue.js等技术构建响应式交互界面，适配PC端与移动端；后端使用Spring Boot框架实现核心业务逻辑开发；数据库使用MySQL存储用户信息、问卷模板、填写数据等结构化数据，搭配ECharts实现数据可视化展示。系统支持问卷全流程数字化管理，包括问卷设计、发布、数据收集、多维度分析和可视化展示等功能，并开发了问卷逻辑校验、数据清洗、多维度统计等核心算法。

## 二、功能模块设计

### 2.1 用户管理模块

#### 2.1.1 功能描述
负责系统用户的注册、登录和基本信息管理。

#### 2.1.2 核心功能
- **用户注册与登录**
  - 用户注册（邮箱/手机号注册）
  - 用户登录（账号密码登录）
  - 密码找回功能
  
- **用户信息管理**
  - 个人资料编辑（头像、昵称、联系方式等）
  - 密码修改

### 2.2 问卷设计模块

#### 2.2.1 功能描述
提供灵活高效的问卷设计与编辑功能，支持多样化题型和丰富的设计选项。

#### 2.2.2 核心功能
- **题型支持**
  - 单选题（单选按钮、下拉选择）
  - 多选题（多选复选框）
  - 填空题（单行文本、多行文本）
  - 评分题（星级评分、滑块评分）
  - 排序题（拖拽排序）
  - 矩阵题（矩阵单选、矩阵多选）
  - 文件上传题
  - 日期时间题

- **问卷设计功能**
  - 可视化拖拽编辑界面
  - 题目添加、删除、复制、移动
  - 题目必填/非必填设置
  - 题目说明文字设置
  - 选项添加、删除、排序
  - 选项图片支持
  - 题目分组与分页设置
  
- **逻辑跳转功能**
  - 条件跳转（根据选项跳转到指定题目）
  - 显示/隐藏逻辑（根据选项显示/隐藏题目）
  - 分页逻辑控制
  - 逻辑规则可视化配置
  
- **样式个性化设置**
  - 问卷主题模板选择
  - 自定义颜色方案（背景色、主题色、文字颜色）
  - 自定义字体设置
  - Logo上传与位置设置
  - 问卷封面图片设置
  - 移动端适配预览

- **模板管理**
  - 系统内置模板库（市场调研、学术研究、满意度调查等）
  - 用户自定义模板保存
  - 模板分类管理

### 2.3 问卷发布与推广模块

#### 2.3.1 功能描述
支持多渠道问卷发布，提供灵活的发布设置和推广工具。

#### 2.3.2 核心功能
- **发布设置**
  - 问卷标题与描述设置
  - 发布状态管理（草稿、发布、暂停、结束）
  - 访问权限设置（公开、密码访问、指定用户、白名单）
  - 填写限制设置（每人限填一次、IP限制、时间限制）
  - 填写截止时间设置
  - 目标填写数量设置
  
- **多渠道发布**
  - 生成问卷链接
  - 生成二维码
  - 嵌入代码生成（iframe嵌入）
  - 社交媒体分享（微信、微博、QQ等）

### 2.4 数据收集模块

#### 2.4.1 功能描述
搭建稳定的数据收集通道，支持大规模问卷填写与数据自动存储。

#### 2.4.2 核心功能
- **数据收集**
  - 问卷填写界面（PC端、移动端自适应）
  - 实时数据提交与保存
  - 草稿保存功能（填写进度保存）
  - **问卷逻辑校验**：题目逻辑验证、必填项校验、选项关联性检查
  - 数据验证（前端验证、后端验证）
  - 防重复提交机制
  
- **数据存储**
  - 结构化数据存储（问卷结构、填写数据）
  - 文件存储（上传的文件、图片，本地存储在后端项目根目录）
  
- **填写体验优化**
  - 填写进度显示
  - 自动保存提示
  - 填写时间统计
  - 移动端优化（触摸友好、响应式布局）

### 2.5 数据统计模块

#### 2.5.1 功能描述
实现数据精准收集与实时统计，提供基础数据统计功能。

#### 2.5.2 核心功能
- **实时统计**
  - 问卷回收率统计（已填写数/目标数）
  - 问卷有效率统计（有效填写数/总填写数）
  - 填写趋势统计（按时间维度）
  - 填写来源统计
  - 设备类型统计（PC、移动端）
  - **实现方式**：使用定时刷新（如每30秒）请求接口获取最新统计数据
  
- **基础数据统计**
  - 各选项选择人数与比例
  - 选项分布统计（饼图、柱状图数据）
  - 填空题词云分析（高频词提取）
  - 评分题平均分统计
  - 排序题排序结果统计
  - **多维度统计算法**：按性别、年龄、地域等多维度进行数据统计
  
- **数据质量分析**
  - 填写时长分析（异常填写识别）
  - 填写完整性分析
  - 数据有效性验证
  - 异常数据标记
  - **数据清洗算法**：去除重复数据、异常数据过滤、缺失值处理

### 2.6 数据分析模块

#### 2.6.1 功能描述
强化多维度数据分析，支持交叉分析、趋势分析、样本画像分析等功能。

#### 2.6.2 核心功能
- **交叉分析**
  - 题目间关联分析（相关性分析）
  - 多维度交叉统计（如：性别×年龄×选项分布）
  - 条件筛选分析（按指定条件筛选数据后分析）
  - 交叉表生成
  
- **趋势分析**
  - 时间趋势分析（按日期统计填写趋势）
  - 选项趋势变化（选项选择率随时间变化）
  
- **样本画像分析**
  - 填写者地域分布分析
  - 填写者年龄分布分析
  - 填写者性别分布分析
  - 填写者行为特征分析（填写时间偏好、设备偏好等）
  - 用户标签生成
  
- **高级分析功能**
  - 数据筛选（按性别、年龄、地域、时间等维度）
  - 数据对比分析（不同时间段、不同群体对比）
  - 数据导出（Excel、CSV、PDF格式）
  - 分析报告PDF导出（包含图表、统计数据、分析结论）

### 2.7 数据可视化模块

#### 2.7.1 功能描述
通过图表可视化展示分析结果，将复杂数据转化为直观结论。

#### 2.7.2 核心功能
- **图表类型**
  - 柱状图（横向、纵向）
  - 饼图（普通饼图、环形图）
  - 折线图（趋势展示）
  - 雷达图（多维度对比）
  - 散点图（相关性分析）
  - 词云图（文本分析）
  
- **可视化功能**
  - 图表自定义配置（颜色、样式、标签）
  - 图表交互（缩放、筛选）
  - 多图表组合展示（仪表盘）
  - 图表导出（PNG、PDF格式）
  - 响应式图表（适配不同屏幕）

### 2.8 安全管理模块

#### 2.8.1 功能描述
保障问卷安全性与数据隐私保护，建立完善的安全机制。

#### 2.8.2 核心功能
- **访问权限控制**
  - 问卷访问权限设置（公开、密码、指定用户）
  - IP白名单/黑名单
  - 访问频率限制（防刷）
  - 问卷有效期控制
  
- **身份验证**
  - 填写者身份验证（登录验证）
  - 匿名填写模式支持
  - 实名填写模式支持
  
- **数据安全**
  - 数据加密存储（敏感数据加密）
  - 数据访问日志记录
  
- **隐私保护**
  - 匿名填写保护
  - 数据脱敏处理（导出时）
  - 隐私协议设置
  - 数据删除功能（用户可删除自己的填写数据）

### 2.9 系统管理模块（管理员后台）

#### 2.9.1 功能描述
系统管理员使用的独立后台管理页面，用于管理系统用户、问卷数据、系统配置等。管理员后台与普通用户前端界面分离，通过独立的登录入口和管理界面进行操作。

#### 2.9.2 核心功能
- **用户管理**
  - 用户列表查看（支持搜索、筛选）
  - 用户信息查看与编辑
  - 用户状态管理（激活、禁用、删除）
  - 用户权限分配
  - 用户注册统计（按时间、来源等维度）
  
- **问卷管理**
  - 全站问卷列表查看（支持搜索、筛选）
  - 问卷详情查看
  - 问卷状态管理（发布、暂停、删除）
  - 问卷审核（如需要）
  - 违规问卷处理
  - 问卷数据统计（问卷数量、填写数量等）
  
- **数据管理**
  - 填写记录查看与管理
  - 数据导出（批量导出问卷数据，支持Excel、CSV、PDF格式）
  - 数据备份与恢复
  - 数据清理（删除过期数据）
  
- **系统监控**
  - 系统运行状态监控
  - 系统数据统计（用户数、问卷数、填写数、活跃度等）
  - 系统日志查看（操作日志、错误日志）
  - 系统性能监控（可选）
  
- **系统配置**
  - 系统参数配置
  - 邮件服务配置
  - 短信服务配置（可选）
  - 文件存储配置
  - 安全策略配置

## 三、技术栈

### 3.1 后端技术栈

#### 3.1.1 核心框架
- **Java 1.8** - 开发语言
- **Spring Boot 2.6.13** - 核心框架，简化Spring应用开发
- **Spring MVC** - Web层框架，处理HTTP请求
- **MyBatis Plus 3.5.x** - ORM框架，简化数据库操作
- **Spring Security** - 安全框架，处理认证与授权
- **Spring AOP** - 面向切面编程，处理日志、事务等

#### 3.1.2 数据存储
- **MySQL 8.0+** - 关系型数据库，存储结构化数据
- **Redis 6.0+** - 缓存数据库，用于：
  - 会话存储
  - 数据缓存（问卷模板、统计数据）
  - 分布式锁
  - 限流控制

#### 3.1.3 认证与授权
- **JWT (JSON Web Token)** - 无状态身份认证
- **Spring Security JWT** - JWT集成
- **BCrypt** - 密码加密

#### 3.1.4 数据处理
- **Jackson** - JSON序列化/反序列化
- **Apache POI** - Excel文件处理（数据导入导出）
- **EasyExcel** - 高性能Excel处理（推荐使用，替代POI）
- **iText / Flying Saucer** - PDF文件生成（数据报告、分析报告导出）


#### 3.1.6 工具类库
- **Lombok** - 简化Java代码
- **Hutool** - Java工具类库
- **Apache Commons** - 通用工具类

#### 3.1.7 接口文档生成
- **Swagger / Knife4j** - API接口文档自动生成工具
  - 自动生成RESTful API文档
  - 支持在线测试接口
  - 提供交互式API文档界面

#### 3.1.8 日志
- **Logback** - 日志框架（Spring Boot默认）
- **SLF4J** - 日志门面

#### 3.1.9 构建工具
- **Maven 3.6+** - 项目构建与依赖管理

#### 3.1.11 文件上传处理
- **Spring Boot Multipart** - 文件上传支持（内置）
- **本地文件系统** - 文件存储在后端项目根目录下的upload文件夹

#### 3.1.10 其他
- **Validation API** - 数据校验
- **Druid** - 数据库连接池
- **本地文件存储** - 文件存储（问卷中的图片、文件上传，存储在后端项目根目录下的upload文件夹）

### 3.2 前端技术栈

#### 3.2.1 核心框架
- **JavaScript** - 脚本语言
- **Vue 3.x** - 渐进式JavaScript框架
- **Vite** - 前端构建工具，快速开发

#### 3.2.2 UI组件库
- **Element Plus** - Vue 3 UI组件库
- **@element-plus/icons-vue** - Element Plus图标库

#### 3.2.3 状态管理
- **Pinia** - Vue 3官方推荐的状态管理库（替代Vuex）

#### 3.2.4 路由
- **Vue Router 4.x** - 前端路由管理

#### 3.2.5 HTTP请求
- **Axios** - HTTP客户端，处理API请求
- **axios拦截器** - 请求/响应拦截（token处理、错误处理）

#### 3.2.6 数据可视化
- **ECharts 5.x** - 数据可视化图表库
- **vue-echarts** - ECharts的Vue组件封装

#### 3.2.7 表单处理
- **@vueuse/core** - Vue组合式API工具集

#### 3.2.8 富文本编辑
- **Quill** - 富文本编辑器（问卷说明、题目描述）

#### 3.2.9 拖拽功能
- **Vue Draggable / SortableJS** - 拖拽排序（问卷题目排序）

#### 3.2.10 工具库
- **Lodash-es** - JavaScript工具库
- **Day.js** - 日期处理库（轻量级替代Moment.js）
- **qrcode.js** - 二维码生成
- **html2canvas** - HTML转图片（图表导出）
- **jsPDF** - PDF文件生成（前端PDF导出，可选）
- **js-file-download** - 文件下载

#### 3.2.11 样式处理
- **Sass / Less** - CSS预处理器
- **PostCSS** - CSS后处理器
- **Autoprefixer** - CSS自动添加浏览器前缀

#### 3.2.12 代码规范
- **ESLint** - JavaScript代码检查
- **Prettier** - 代码格式化

### 3.3 数据库设计

#### 3.3.1 数据库
- **MySQL 8.0+** - 主数据库

#### 3.3.2 主要数据表（建议）
- **用户表** (user) - 用户基本信息
- **角色表** (role) - 角色定义
- **权限表** (permission) - 权限定义
- **用户角色关联表** (user_role) - 用户角色关系
- **问卷表** (survey) - 问卷基本信息
- **题目表** (question) - 题目信息
- **选项表** (option) - 题目选项
- **逻辑规则表** (logic_rule) - 逻辑跳转规则
- **填写记录表** (response) - 问卷填写记录
- **填写答案表** (answer) - 具体答案
- **模板表** (template) - 问卷模板
- **文件表** (file) - 上传文件信息
- **统计表** (statistics) - 统计数据缓存
- **日志表** (log) - 操作日志

### 3.4 开发工具

#### 3.4.1 IDE
- **IntelliJ IDEA** - Java开发IDE（推荐）
- **VS Code** - 前端开发IDE

#### 3.4.2 版本控制
- **Git** - 版本控制系统
- **GitHub / GitLab / Gitee** - 代码托管平台

#### 3.4.3 数据库工具
- **Navicat / DBeaver / DataGrip** - 数据库管理工具

#### 3.4.4 API测试
- **Postman / Apifox** - API接口测试工具

#### 3.4.5 其他工具
- **Redis Desktop Manager** - Redis管理工具
- **Xshell / MobaXterm** - 远程连接工具（如需要）

### 3.5 部署相关

#### 3.5.1 容器化（可选）
- **Docker** - 容器化部署
- **Docker Compose** - 多容器编排

#### 3.5.2 Web服务器
- **Nginx** - 反向代理、静态资源服务器
- **Tomcat** - Java应用服务器（Spring Boot内嵌）

#### 3.5.3 监控（可选）
- **Spring Boot Actuator** - 应用监控
- **Prometheus + Grafana** - 监控与可视化（可选）

## 四、系统架构

### 4.1 整体架构
```
┌─────────────────────────────────────────┐
│        前端层 (Vue3)                     │
│  ┌───────────────────────────────────┐  │
│  │   用户前端界面                     │  │
│  │  - 问卷设计器                      │  │
│  │  - 数据可视化                      │  │
│  │  - 问卷填写界面                    │  │
│  └───────────────────────────────────┘  │
│  ┌───────────────────────────────────┐  │
│  │   管理员后台界面（独立页面）        │  │
│  │  - 用户管理                        │  │
│  │  - 问卷管理                        │  │
│  │  - 数据管理                        │  │
│  │  - 系统监控                        │  │
│  └───────────────────────────────────┘  │
└─────────────────┬───────────────────────┘
                  │ HTTP
┌─────────────────▼───────────────────────┐
│         API网关层 (Nginx)                │
│  - 反向代理                              │
│  - 负载均衡                              │
└─────────────────┬───────────────────────┘
                  │
┌─────────────────▼───────────────────────┐
│      后端服务层 (Spring Boot)            │
│  - 业务逻辑处理                          │
│  - 接口服务                              │
│  - 安全认证                              │
│  - 管理员权限验证                        │
└─────┬───────────────┬───────────────────┘
      │               │
┌─────▼─────┐   ┌─────▼─────┐
│  MySQL    │   │   Redis   │
│  数据库    │   │   缓存    │
└───────────┘   └───────────┘
```

### 4.2 技术架构分层

#### 4.2.1 前端架构
- **用户前端**
  - 视图层 - Vue组件、页面（问卷设计、数据可视化等）
  - 状态管理层 - Pinia状态管理
  - 服务层 - API请求封装
  - 工具层 - 工具函数、工具类
  
- **管理员后台（独立页面）**
  - 视图层 - 管理后台专用Vue组件、页面
  - 状态管理层 - Pinia状态管理（独立store）
  - 服务层 - 管理后台API请求封装
  - 权限控制 - 路由守卫、权限验证

#### 4.2.2 后端架构
- **Controller层** - 接口控制器
- **Service层** - 业务逻辑层
- **Mapper层** - 数据访问层（MyBatis Plus）
- **Entity层** - 实体类
- **DTO/VO层** - 数据传输对象/视图对象
- **Config层** - 配置类
- **Utils层** - 工具类

## 五、开发计划建议

### 5.1 第一阶段：基础功能
- 用户管理模块（注册、登录）
- 问卷设计模块（基础题型、题目编辑）
- 问卷发布模块（发布设置、链接生成）
- 数据收集模块（填写界面、数据存储）
- 管理员后台基础框架（独立页面、登录）

### 5.2 第二阶段：核心功能
- 数据统计模块（实时统计、基础统计）
- 数据分析模块（交叉分析、趋势分析、样本画像）
- 数据可视化模块（图表展示）
- 管理员后台用户管理功能

### 5.3 第三阶段：高级功能
- 逻辑跳转功能
- 样式个性化设置
- 模板管理
- 安全管理模块（权限控制、数据加密）
- 管理员后台完整功能（问卷管理、数据管理、系统监控）

### 5.4 第四阶段：优化与测试
- 性能优化
- 系统测试
- 用户体验优化
- 管理员后台功能完善

## 六、文件存储说明

### 6.1 存储位置
- 所有上传的文件（图片、文档等）存储在**后端项目根目录下的upload文件夹**
- 建议目录结构：
  ```
  survey-analyst-server/
  ├── upload/
  │   ├── images/        # 图片文件
  │   ├── documents/     # 文档文件
  │   └── temp/          # 临时文件
  ```

### 6.2 文件管理
- 文件按日期或用户ID分类存储
- 定期清理临时文件和过期文件
- 文件访问通过后端接口提供，确保安全性

## 七、管理员后台说明

### 7.1 后台架构
- **独立页面**：管理员后台为独立的前端页面，与普通用户前端界面分离
- **独立路由**：使用独立的路由前缀（如 `/admin`）进行访问控制
- **权限验证**：通过JWT Token和角色权限验证，确保只有管理员可以访问
- **统一风格**：使用Element Plus组件库，保持与用户前端界面风格一致

### 7.2 访问控制
- **登录入口**：独立的管理员登录页面（如 `/admin/login`）
- **权限拦截**：前端路由守卫 + 后端接口权限验证
- **角色管理**：通过角色表（role）和用户角色关联表（user_role）实现权限分配

### 7.3 功能特点
- **数据集中管理**：统一管理用户、问卷、填写数据等
- **批量操作**：支持批量删除、批量导出等操作
- **数据统计**：提供系统整体数据统计和可视化展示
- **操作日志**：记录管理员的所有操作，便于审计

## 八、技术选型说明

### 8.1 PDF导出功能
- **后端PDF生成**：使用iText或Flying Saucer生成PDF文件
  - 适用于：数据报告、分析报告、问卷数据导出
  - 优势：格式规范、支持复杂布局、可包含图表
- **前端PDF生成**：使用jsPDF（可选）
  - 适用于：简单PDF导出、图表转PDF
  - 优势：减少服务器压力、响应快速
- **应用场景**：
  - 问卷数据分析报告导出（包含统计图表、数据表格、分析结论）
  - 问卷填写数据批量导出
  - 管理员后台数据报表导出

### 8.2 实时统计实现方式
- **实现方案**：使用定时刷新方式
  - 前端定时（如30秒）请求接口获取最新统计数据
  - 优点：实现简单、无需额外技术栈、降低系统复杂度
  - 适用场景：问卷填写频率不高，定时刷新即可满足需求

## 九、总结

本系统采用前后端分离架构，后端使用Spring Boot + MyBatis Plus构建RESTful API，前端使用Vue3 + Element Plus构建响应式用户界面。系统包含两个独立的前端界面：普通用户前端和管理员后台。管理员后台为独立页面，用于管理用户、问卷数据、系统配置等，通过独立的登录入口和权限验证机制确保安全性。系统功能模块精简实用，技术栈成熟稳定，能够满足论文摘要中提出的在线问卷调查与数据分析的核心需求。文件采用本地存储方式，存储在后端项目根目录下，简化部署和维护。通过模块化设计，系统具有良好的可扩展性和可维护性。

